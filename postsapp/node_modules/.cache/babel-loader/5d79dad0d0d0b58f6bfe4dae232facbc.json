{"ast":null,"code":"import _regeneratorRuntime from\"/home/artem/PostMessageAppReact-/postsapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/artem/PostMessageAppReact-/postsapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/artem/PostMessageAppReact-/postsapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import\"../App.css\";import InputArea from\"./InputArea\";import PostsArea from\"./PostsArea\";import{Grid}from\"@material-ui/core\";import Header from\"./Header\";var Dashboard=function Dashboard(_ref){var setAuth=_ref.setAuth;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),arr=_useState2[0],setArray=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),id=_useState6[0],setId=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),email=_useState8[0],setEmail=_useState8[1];var getName=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,parseRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/api/dashboard\",{method:\"GET\",headers:{token:localStorage.token}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:parseRes=_context.sent;setName(parseRes.user_name);setId(parseRes.user_id);setEmail(parseRes.user_email);_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function getName(){return _ref2.apply(this,arguments);};}();useEffect(function(){getName();});var addHandler=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref3,post_date,user_id){var txt_content,body,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:txt_content=_ref3.txt_content;_context2.prev=1;if(!(txt_content===\"\")){_context2.next=4;break;}return _context2.abrupt(\"return\");case 4:body={txt_content:txt_content,post_date:post_date,user_id:user_id};_context2.next=7;return fetch(\"/api/posts/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 7:response=_context2.sent;getPosts();_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0.message);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,11]]);}));return function addHandler(_x,_x2,_x3){return _ref4.apply(this,arguments);};}();var deleteHandler=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var deletePost;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"/api/posts/\".concat(id),{method:\"DELETE\"});case 3:deletePost=_context3.sent;console.log(deletePost);setArray(arr.filter(function(arr){return arr.post_id!==id;}));_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0.message);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function deleteHandler(_x4){return _ref5.apply(this,arguments);};}();var updateHandler=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id,_ref6){var txt_content,body,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:txt_content=_ref6.txt_content;_context4.prev=1;if(!(txt_content===\"\")){_context4.next=4;break;}return _context4.abrupt(\"return\");case 4:body={txt_content:txt_content};_context4.next=7;return fetch(\"/api/posts/\".concat(id),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 7:response=_context4.sent;console.log(response);_context4.next=14;break;case 11:_context4.prev=11;_context4.t0=_context4[\"catch\"](1);console.log(_context4.t0.message);case 14:case\"end\":return _context4.stop();}}},_callee4,null,[[1,11]]);}));return function updateHandler(_x5,_x6){return _ref7.apply(this,arguments);};}();var getPosts=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var response,jsonData;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return fetch(\"/api/posts/\");case 3:response=_context5.sent;_context5.next=6;return response.json();case 6:jsonData=_context5.sent;setArray(jsonData);_context5.next=13;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](0);console.error(_context5.t0.message);case 13:case\"end\":return _context5.stop();}}},_callee5,null,[[0,10]]);}));return function getPosts(){return _ref8.apply(this,arguments);};}();useEffect(function(){getPosts();},[]);return/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\"},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Header,{setAuth:setAuth})),/*#__PURE__*/React.createElement(Grid,{item:true,container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:1}),/*#__PURE__*/React.createElement(\"h2\",null,\"Welcome: \",name)),/*#__PURE__*/React.createElement(Grid,{item:true,container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:2}),/*#__PURE__*/React.createElement(Grid,{item:true,xs:8},/*#__PURE__*/React.createElement(InputArea,{addHandler:addHandler,id:id}),/*#__PURE__*/React.createElement(PostsArea,{deleteHandler:deleteHandler,updateHandler:updateHandler,arr:arr})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:2})));};export default Dashboard;","map":{"version":3,"sources":["/home/artem/PostMessageAppReact-/postsapp/src/components/Dashboard.js"],"names":["React","useState","useEffect","InputArea","PostsArea","Grid","Header","Dashboard","setAuth","arr","setArray","name","setName","id","setId","email","setEmail","getName","fetch","method","headers","token","localStorage","response","json","parseRes","user_name","user_id","user_email","console","error","message","addHandler","post_date","txt_content","body","JSON","stringify","getPosts","deleteHandler","deletePost","log","filter","post_id","updateHandler","jsonData"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"../App.css\";\nimport InputArea from \"./InputArea\";\nimport PostsArea from \"./PostsArea\";\nimport { Grid } from \"@material-ui/core\";\nimport Header from \"./Header\";\n\nconst Dashboard = ({ setAuth }) => {\n  const [arr, setArray] = useState([]);\n  const [name, setName] = useState(\"\");\n  const [id, setId] = useState(\"\");\n  const [email,setEmail] = useState(\"\");\n\n  const getName = async () => {\n    try {\n      const response = await fetch(\"/api/dashboard\", {\n        method: \"GET\",\n        headers: { token: localStorage.token },\n      });\n      const parseRes = await response.json();\n      setName(parseRes.user_name);\n      setId(parseRes.user_id);\n      setEmail(parseRes.user_email)\n    } catch (error) {\n      console.error(error.message);\n    }\n  };\n\n  useEffect(() => {\n    getName();\n  });\n\n  const addHandler = async ({ txt_content }, post_date, user_id) => {\n    try {\n      if (txt_content === \"\") return;\n      const body = { txt_content, post_date, user_id };\n      const response = await fetch(\"/api/posts/\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(body),\n      });\n      getPosts();\n    } catch (error) {\n      console.error(error.message);\n    }\n  };\n\n  const deleteHandler = async (id) => {\n    try {\n      const deletePost = await fetch(`/api/posts/${id}`, {\n        method: \"DELETE\",\n      });\n      console.log(deletePost);\n      setArray(arr.filter((arr) => arr.post_id !== id));\n    } catch (error) {\n      console.error(error.message);\n    }\n  };\n\n  const updateHandler = async (id, { txt_content }) => {\n    try {\n      if (txt_content === \"\") return;\n      const body = { txt_content };\n      const response = await fetch(`/api/posts/${id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(body),\n      });\n      console.log(response);\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n\n  const getPosts = async () => {\n    try {\n      const response = await fetch(\"/api/posts/\");\n      const jsonData = await response.json();\n      setArray(jsonData);\n    } catch (error) {\n      console.error(error.message);\n    }\n  };\n\n  useEffect(() => {\n    getPosts();\n  }, []);\n\n  return (\n    <Grid container direction=\"column\">\n      <Grid item>\n        <Header setAuth={setAuth} />\n      </Grid>\n      <Grid item container>\n      <Grid item xs={1} />\n\n        <h2>Welcome: {name}</h2>\n      </Grid>\n      <Grid item container>\n        <Grid item xs={2} />\n        <Grid item xs={8}>\n          <InputArea addHandler={addHandler} id={id} />\n          <PostsArea\n            deleteHandler={deleteHandler}\n            updateHandler={updateHandler}\n            arr={arr}\n          />\n        </Grid>\n        <Grid item xs={2} />\n      </Grid>\n    </Grid>\n  );\n};\nexport default Dashboard;\n"]},"metadata":{},"sourceType":"module"}